<!doctype html>
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="twitter:site" content="skywalking.apache.org">
<meta name="twitter:image:src" content="https://skywalking.apache.org/images/skywalking_400x400.png">
<meta property="og:image" content="https://skywalking.apache.org/images/skywalking_400x400.png">
<meta name="generator" content="Hugo 0.80.0" />
<META NAME="ROBOTS" CONTENT="INDEX, FOLLOW">
<link rel="stylesheet" href="//at.alicdn.com/t/font_3007530_1h1a8yq155l.css">



<link rel="apple-touch-icon" sizes="180x180" href="/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicons/favicon-16x16.png">
<link rel="manifest" href="/favicons/site.webmanifest">
<link rel="mask-icon" href="/favicons/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">

<title>Java agent injector Usage | Apache SkyWalking</title><meta property="og:title" content="Java agent injector Usage" />
<meta property="og:description" content="Java agent injector Usage In this example, you will learn how to use the java agent injector in three ways.
Install injector The java agent injector is a component of the operator, so you need to follow Operator installation instrument to install the operator firstly.
Use default configuration At first, set the injection label in your namespace as below.
kubectl label namespace default(your namespace) swck-injection=enabled Then add swck-java-agent-injected: &quot;true&quot; in the labels of the yaml file as below." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/docs/skywalking-swck/latest/examples/java-agent-injector-usage/" />

<meta itemprop="name" content="Java agent injector Usage">
<meta itemprop="description" content="Java agent injector Usage In this example, you will learn how to use the java agent injector in three ways.
Install injector The java agent injector is a component of the operator, so you need to follow Operator installation instrument to install the operator firstly.
Use default configuration At first, set the injection label in your namespace as below.
kubectl label namespace default(your namespace) swck-injection=enabled Then add swck-java-agent-injected: &quot;true&quot; in the labels of the yaml file as below.">

<meta itemprop="wordCount" content="974">



<meta itemprop="keywords" content="" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Java agent injector Usage"/>
<meta name="twitter:description" content="Java agent injector Usage In this example, you will learn how to use the java agent injector in three ways.
Install injector The java agent injector is a component of the operator, so you need to follow Operator installation instrument to install the operator firstly.
Use default configuration At first, set the injection label in your namespace as below.
kubectl label namespace default(your namespace) swck-injection=enabled Then add swck-java-agent-injected: &quot;true&quot; in the labels of the yaml file as below."/>

<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-178891182-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>



<link rel="preload" href="/scss/main.min.c380d3397ab3a5c36ae4fd86d7dd7c375c70ed691c44adb6fd34b20c093ddc7e.css" as="style">
<link href="/scss/main.min.c380d3397ab3a5c36ae4fd86d7dd7c375c70ed691c44adb6fd34b20c093ddc7e.css" rel="stylesheet" integrity="">



<link rel="stylesheet" href="/css/docSearch.css" />


<script src="/js/jquery-3.6.0.min.js"></script>





    <title>Java agent injector Usage | Apache SkyWalking</title>
  </head>
  <body class="td-page  project-doc">
    <header>
      
<nav class="js-navbar-scroll navbar navbar-expand  flex-column flex-md-row td-navbar">
    <div class="sidebar-button">
      <i class="iconfont icon-menu"></i>
    </div>
    <a class="navbar-brand" href="/">
        <span class="navbar-logo"><img width="130" src="/images/logo.svg" alt="SkyWalking"></span> 
    </a>
    <div class="td-navbar-nav-scroll navbar-nav-wrapper" id="navigation">
        <ul class="navbar-nav mt-lg-0">
             
            
            
            <li class="nav-item mr-3 mb-lg-0">
				
				
				
				
				<a class="nav-link" href="/docs" ><span>Projects and Docs</span></a>
			</li>
             
            
            
            <li class="nav-item mr-3 mb-lg-0">
				
				
				
				
				<a class="nav-link" href="/events" ><span>Events</span></a>
			</li>
             
            
            
            <li class="nav-item mr-3 mb-lg-0">
				
				
				
				
				<a class="nav-link" href="/blog" ><span>Blogs</span></a>
			</li>
             
            
            
            <li class="nav-item mr-3 mb-lg-0">
				
				
				
				
				<a class="nav-link" href="/downloads" ><span>Downloads</span></a>
			</li>
             
            
            
            <li class="nav-item mr-3 mb-lg-0">
				
				
				
				
				<a class="nav-link" href="/team" ><span>Team</span></a>
			</li>
             
            
            
            <li class="nav-item mr-3 mb-lg-0">
				
				
				
				
				<a class="nav-link" href="/users" ><span>Users</span></a>
			</li>
             
            
            
            <li class="nav-item mr-3 mb-lg-0">
				
				
				
				
				<a class="nav-link" href="/zh" ><span>中文博客</span></a>
			</li>
             
            
             
            
			
        </ul>
    </div>
    <div class="navbar-nav d-none d-lg-block search-input-box">
         
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
            <span class="link dropdown">
                <a class="link-name dropdown-toggle" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    Links
                </a>
                <div class="dropdown-menu">
                    
                    <a class="dropdown-item" href="http://www.apache.org/">Apache Software Foundation</a> 
                    <a class="dropdown-item" href="https://github.com/apache/skywalking/issues">GitHub Issue Tracker</a> 
                    <a class="dropdown-item" href="https://github.com/apache/skywalking/discussions">Discussion</a> 
                    <a class="dropdown-item" href="https://lists.apache.org/list.html?dev@skywalking.apache.org">Dev Mailing List</a> 
                    <a class="dropdown-item" href="https://cwiki.apache.org/confluence/display/SKYWALKING/Home">WIKI</a> 
                    <a class="dropdown-item" href="http://www.apache.org/licenses/">License</a> 
                    <a class="dropdown-item" href="http://www.apache.org/events/current-event">Apache Events</a> 
                    <a class="dropdown-item" href="http://www.apache.org/security/">Security</a> 
                    <a class="dropdown-item" href="http://www.apache.org/foundation/sponsorship.html">Sponsor and Donate</a> 
                    <a class="dropdown-item" href="http://www.apache.org/foundation/thanks.html">Thanks</a> 
                </div>
            </span>
            
        
        
<div id="docsearch"></div>


    </div>
</nav>

    </header>
    <div class="container-fluid td-outer">

      <div class="td-main">
        <div class="row flex-xl-nowrap">
          <div class="col-12 col-md-3 col-xl-2 d-print-none scroll-bar td-sidebar">



















                  <div class="description-wrapper">
                    <h5>
                    <img width="26" height="26" src="/images/project/kubernetes.svg">
                    skywalking-swck
                    </h5>
                    <p>A bridge project between Apache SkyWalking and Kubernetes.</p>
                  </div>
                  
                  <div class="version-wrapper">Version: 
                  <select class="version-select">
                  
                    
                    
                    <option selected value="latest">
                    
                      latest
                    
                    </option>
                  
                    
                    
                    <option ZgotmplZ value="v0.6.1">
                    
                      v0.6.1
                    
                    </option>
                  
                  </select>
                  </div>
                  
                  <ul class="sidebar-menu">
    
    <li>
        
            <a href="/docs/skywalking-swck/latest/readme">Welcome</a>
        
    </li>
    
    <li>
        
            
            <a href="#">Designs<i class="iconfont icon-arrow-right pull-right"></i></a>
            

            
<ul class="sidebar-submenu">
    

    <li>
        
            <a href="/docs/skywalking-swck/latest/design/proposal">Proposal</a>
        
    </li>

    

</ul>

        
    </li>
    
    <li>
        
            
            <a href="#">Setup<i class="iconfont icon-arrow-right pull-right"></i></a>
            

            
<ul class="sidebar-submenu">
    

    <li>
        
            <a href="/docs/skywalking-swck/latest/java-agent-injector">Java Agent Injector</a>
        
    </li>

    

    <li>
        
            <a href="/docs/skywalking-swck/latest/operator">Operator</a>
        
    </li>

    

    <li>
        
            <a href="/docs/skywalking-swck/latest/custom-metrics-adapter">Adapter</a>
        
    </li>

    

</ul>

        
    </li>
    
    <li>
        
            
            <a href="#">Examples<i class="iconfont icon-arrow-right pull-right"></i></a>
            

            
<ul class="sidebar-submenu">
    

    <li>
        
            <a href="/docs/skywalking-swck/latest/examples/java-agent-injector-usage">Inject Java Agent</a>
        
    </li>

    

    <li>
        
            <a href="/docs/skywalking-swck/latest/examples/default-backend">Deploy OAP and UI</a>
        
    </li>

    

    <li>
        
            <a href="/docs/skywalking-swck/latest/examples/storage">Deploy Storage</a>
        
    </li>

    

    <li>
        
            <a href="/docs/skywalking-swck/latest/examples/istio-controlplane">Fetch metrics</a>
        
    </li>

    

    <li>
        
            <a href="/docs/skywalking-swck/latest/examples/satellite">Install Satellite</a>
        
    </li>

    

</ul>

        
    </li>
    
    <li>
        
            
            <a href="#">Contributing Guides<i class="iconfont icon-arrow-right pull-right"></i></a>
            

            
<ul class="sidebar-submenu">
    

    <li>
        
            <a href="https://skywalking.apache.org/docs/main/latest/en/guides/readme/">Contribute</a>
        
    </li>

    

    <li>
        
            <a href="https://skywalking.apache.org/docs/main/latest/en/guides/asf/committer/">Become A Committer</a>
        
    </li>

    

    <li>
        
            <a href="/docs/skywalking-swck/latest/release">Release Guide</a>
        
    </li>

    

</ul>

        
    </li>
    
    <li>
        
            <a href="https://github.com/apache/skywalking-swck/tree/master/changes">Changelog</a>
        
    </li>
    
</ul>
<script src="/js/sidebar-menu.js"></script>
<script>
  (function (){
    $.sidebarMenu($('.sidebar-menu'))
    var path = window.location.pathname;
    var hash = window.location.hash;
    var $a = $('.sidebar-menu a')
    $a.each(function (e){
      if($(this).attr('href')+'/' === path || $(this).attr('href').replace('#','/#') === path+hash){
        $(this).parents('li').addClass('active').show()
      }
    })
    $a.on('click',function (){
      var url = $(this).attr('href')
      if(url!=='#'){
        window.location.href = url
      }
    })
  })()
</script>

                  <div class="commit-id">Commit Id: e822fca</div>
                






</div>
            <main class="col-12 col-md-9 col-xl-8 pl-md-5 pr-md-4" role="main">
              <i class="iconfont icon-menu-doc doc-menu-button"></i>
              
<div class="td-content">











	<h1 id="java-agent-injector-usage">Java agent injector Usage</h1>
<p>In this example, you will learn how to use the java agent injector in three ways.</p>
<h2 id="install-injector">Install injector</h2>
<p>The java agent injector is a component of the operator, so you need to follow <a href="https://github.com/apache/skywalking-swck/tree/e822fca26c0f6b15fac3d9d9a936dc4f4ccb9707/README.md#operator">Operator installation instrument</a> to install the operator firstly.</p>
<h2 id="use-default-configuration">Use default configuration</h2>
<p>At first, set the injection label in your namespace as below.</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">kubectl label namespace default<span style="color:#000;font-weight:bold">(</span>your namespace<span style="color:#000;font-weight:bold">)</span> swck-injection<span style="color:#000;font-weight:bold">=</span>enabled
</code></pre></div><p>Then add <code>swck-java-agent-injected: &quot;true&quot;</code> in the labels of the yaml file as below.</p>
<pre><code>apiVersion: apps/v1
kind: Deployment
metadata:
  name: demo1
  namespace: default
spec:
  selector:
    matchLabels:
      app: demo1
  template:
    metadata:
      labels:
        swck-java-agent-injected: &quot;true&quot;
        app: demo1
    spec:
      containers:
      - name: demo1
        image: ghcr.io/apache/skywalking-swck-spring-demo:v0.0.1
        command: [&quot;java&quot;]
        args: [&quot;-jar&quot;,&quot;/app.jar&quot;]
   
</code></pre><p>Get injected resources as below:</p>
<pre><code>spec:
  containers:
  - args:
    - -jar
    - /app.jar
    command:
    - java
    env:
    - name: JAVA_TOOL_OPTIONS
      value: -javaagent:/sky/agent/skywalking-agent.jar
    image: ghcr.io/apache/skywalking-swck-spring-demo:v0.0.1
    name: demo1
    - mountPath: /sky/agent
      name: sky-agent
    - mountPath: /sky/agent/config
      name: java-agent-configmap-volume
  initContainers:
  - args:
    - -c
    - mkdir -p /sky/agent &amp;&amp; cp -r /skywalking/agent/* /sky/agent
    command:
    - sh
    image: apache/skywalking-java-agent:8.10.0-java8
    name: inject-skywalking-agent
    volumeMounts:
    - mountPath: /sky/agent
      name: sky-agent
  volumes:
  - emptyDir: {}
    name: sky-agent
  - configMap:
      name: skywalking-swck-java-agent-configmap
    name: java-agent-configmap-volume
</code></pre><div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ kubectl get configmap skywalking-swck-java-agent-configmap -n default<span style="color:#000;font-weight:bold">(</span>your namespace<span style="color:#000;font-weight:bold">)</span>
NAME                                   DATA   AGE
skywalking-swck-java-agent-configmap   <span style="color:#099">1</span>      61s
</code></pre></div><p>Then you can get the final agent configuration and the pod as below.</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ kubectl get javaagent
NAME                  PODSELECTOR   SERVICENAME            BACKENDSERVICE
app-demo1-javaagent   <span style="color:#008080">app</span><span style="color:#000;font-weight:bold">=</span>demo1     Your_ApplicationName   127.0.0.1:11800
$ kubectl get pod -l <span style="color:#008080">app</span><span style="color:#000;font-weight:bold">=</span>demo1<span style="color:#000;font-weight:bold">(</span>the podSelector<span style="color:#000;font-weight:bold">)</span>
NAME                     READY   STATUS    RESTARTS   AGE
demo1-8554b96b4c-6czv7   1/1     Running   <span style="color:#099">0</span>          85s
</code></pre></div><p>Get the javaagent&rsquo;s yaml for more datails.</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ kubectl get javaagent app-demo1-javaagent -oyaml
apiVersion: operator.skywalking.apache.org/v1alpha1
kind: JavaAgent
metadata:
  creationTimestamp: <span style="color:#d14">&#34;2021-10-15T04:52:46Z&#34;</span>
  generation: <span style="color:#099">1</span>
  name: app-demo1-javaagent
  namespace: default
  ownerReferences:
  - apiVersion: apps/v1
    blockOwnerDeletion: <span style="color:#0086b3">true</span>
    controller: <span style="color:#0086b3">true</span>
    kind: ReplicaSet
    name: demo1-8554b96b4c
    uid: f3d71b5c-1e26-401a-8d0d-055d1e89bc64
  resourceVersion: <span style="color:#d14">&#34;455104&#34;</span>
  selfLink: /apis/operator.skywalking.apache.org/v1alpha1/namespaces/default/javaagents/app-demo1-javaagent
  uid: 2bf828d6-4f83-4c7d-9356-83066ae334d3
spec:
  agentConfiguration:
    agent.service_name: Your_ApplicationName
    collector.backend_service: 127.0.0.1:11800
  backendService: 127.0.0.1:11800
  podSelector: <span style="color:#008080">app</span><span style="color:#000;font-weight:bold">=</span>demo1
  serviceName: Your_ApplicationName
status:
  creationTime: <span style="color:#d14">&#34;2021-10-15T04:52:46Z&#34;</span>
  expectedInjectiedNum: <span style="color:#099">1</span>
  lastUpdateTime: <span style="color:#d14">&#34;2021-10-15T04:52:49Z&#34;</span>
  realInjectedNum: <span style="color:#099">1</span>
</code></pre></div><h2 id="use-annotation-to-override-sidecar-configuration">Use annotation to override sidecar configuration</h2>
<p>At first, set the injection label in your namespace as below.</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">kubectl label namespace default<span style="color:#000;font-weight:bold">(</span>your namespace<span style="color:#000;font-weight:bold">)</span> swck-injection<span style="color:#000;font-weight:bold">=</span>enabled
</code></pre></div><p>Then add <code>swck-java-agent-injected: &quot;true&quot;</code> in the labels of yaml file and add the <a href="../../java-agent-injector#configure-sidecar">sidecar configuration</a> to the annotations as below.</p>
<pre><code>apiVersion: apps/v1
kind: Deployment
metadata:
  name: demo2
  namespace: default
spec:
  selector:
    matchLabels:
      app: demo2
  template:
    metadata:
      labels:
        swck-java-agent-injected: &quot;true&quot;
        app: demo2
      annotations:
        sidecar.skywalking.apache.org/initcontainer.Name: &quot;test-inject-agent&quot;
        sidecar.skywalking.apache.org/initcontainer.Image: &quot;apache/skywalking-java-agent:8.5.0-jdk8&quot;
        sidecar.skywalking.apache.org/initcontainer.Command: &quot;sh&quot;
        sidecar.skywalking.apache.org/initcontainer.args.Option: &quot;-c&quot;
        sidecar.skywalking.apache.org/initcontainer.args.Command: &quot;mkdir -p /skytest/agent &amp;&amp; cp -r /skywalking/agent/* /skytest/agent&quot;
        sidecar.skywalking.apache.org/sidecarVolumeMount.MountPath: &quot;/skytest/agent&quot;
        sidecar.skywalking.apache.org/configmapVolumeMount.MountPath: &quot;/skytest/agent/config&quot;
        sidecar.skywalking.apache.org/configmapVolume.ConfigMap.Name: &quot;newconfigmap&quot;
        sidecar.skywalking.apache.org/env.Value: &quot;-javaagent:/skytest/agent/skywalking-agent.jar&quot;
    spec:
      containers:
      - name: demo2
        image: ghcr.io/apache/skywalking-swck-spring-demo:v0.0.1
        command: [&quot;java&quot;]
        args: [&quot;-jar&quot;,&quot;/app.jar&quot;]
</code></pre><p>Get injected resources as below:</p>
<pre><code>spec:
  containers:
  - args:
    - -jar
    - /app.jar
    command:
    - java
    env:
    - name: JAVA_TOOL_OPTIONS
      value: -javaagent:/skytest/agent/skywalking-agent.jar
    image: ghcr.io/apache/skywalking-swck-spring-demo:v0.0.1
    name: demo2
    - mountPath: /skytest/agent
      name: sky-agent
    - mountPath: /skytest/agent/config
      name: java-agent-configmap-volume
  initContainers:
  - args:
    - -c
    - mkdir -p /skytest/agent &amp;&amp; cp -r /skywalking/agent/* /skytest/agent
    command:
    - sh
    image: apache/skywalking-java-agent:8.5.0-jdk8
    name: test-inject-agent
    volumeMounts:
    - mountPath: /skytest/agent
      name: sky-agent
  volumes:
  - emptyDir: {}
    name: sky-agent
  - configMap:
      name: newconfigmap
    name: java-agent-configmap-volume
</code></pre><div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ kubectl get configmap newconfigmap -n default
NAME           DATA   AGE
newconfigmap   <span style="color:#099">1</span>      2m29s
</code></pre></div><p>Then you can get the final agent configuration and the pod as below.</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ kubectl get javaagent
NAME                  PODSELECTOR   SERVICENAME            BACKENDSERVICE
app-demo2-javaagent   <span style="color:#008080">app</span><span style="color:#000;font-weight:bold">=</span>demo2     Your_ApplicationName   127.0.0.1:11800
$ kubectl get pod -l <span style="color:#008080">app</span><span style="color:#000;font-weight:bold">=</span>demo2<span style="color:#000;font-weight:bold">(</span>the podSelector<span style="color:#000;font-weight:bold">)</span>
NAME                     READY   STATUS    RESTARTS   AGE
demo2-74b65f98b9-k5wvd   1/1     Running   <span style="color:#099">0</span>          3m28s
</code></pre></div><p>Get the javaagent&rsquo;s yaml for more datails.</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ kubectl get javaagent app-demo2-javaagent -oyaml
apiVersion: operator.skywalking.apache.org/v1alpha1
kind: JavaAgent
metadata:
  creationTimestamp: <span style="color:#d14">&#34;2021-10-15T05:10:16Z&#34;</span>
  generation: <span style="color:#099">1</span>
  name: app-demo2-javaagent
  namespace: default
  ownerReferences:
  - apiVersion: apps/v1
    blockOwnerDeletion: <span style="color:#0086b3">true</span>
    controller: <span style="color:#0086b3">true</span>
    kind: ReplicaSet
    name: demo2-74b65f98b9
    uid: cbc2c680-4f84-469a-bb43-fc48161d6958
  resourceVersion: <span style="color:#d14">&#34;458626&#34;</span>
  selfLink: /apis/operator.skywalking.apache.org/v1alpha1/namespaces/default/javaagents/app-demo2-javaagent
  uid: 7c59aab7-30fc-4122-8b39-4cba2d1711b5
spec:
  agentConfiguration:
    agent.service_name: Your_ApplicationName
    collector.backend_service: 127.0.0.1:11800
  backendService: 127.0.0.1:11800
  podSelector: <span style="color:#008080">app</span><span style="color:#000;font-weight:bold">=</span>demo2
  serviceName: Your_ApplicationName
status:
  creationTime: <span style="color:#d14">&#34;2021-10-15T05:10:16Z&#34;</span>
  expectedInjectiedNum: <span style="color:#099">1</span>
  lastUpdateTime: <span style="color:#d14">&#34;2021-10-15T05:10:18Z&#34;</span>
  realInjectedNum: <span style="color:#099">1</span>
</code></pre></div><h4 id="use-annotation-to-set-the-coverage-strategy-and-override-the-agent-configuration">Use annotation to set the coverage strategy and override the agent configuration</h4>
<p>At first, set the injection label in your namespace as below.</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">kubectl label namespace default<span style="color:#000;font-weight:bold">(</span>your namespace<span style="color:#000;font-weight:bold">)</span> swck-injection<span style="color:#000;font-weight:bold">=</span>enabled
</code></pre></div><p>Then add <code>swck-java-agent-injected: &quot;true&quot;</code> in the labels of yaml file and <a href="../../java-agent-injector#use-annotations-to-overlay-default-agent-configuration">agent configuration</a> and <a href="../../java-agent-injector#configure-sidecar">sidecar configuration</a> to annotations as below.</p>
<pre><code>apiVersion: apps/v1
kind: Deployment
metadata:
  name: demo3
  namespace: default
spec:
  replicas: 3
  selector:
    matchLabels:
      app: demo3
  template:
    metadata:
      name: inject-demo3
      labels:
        swck-java-agent-injected: &quot;true&quot;
        app: demo3
      annotations:
        strategy.skywalking.apache.org/inject.Container: &quot;demo&quot;
        strategy.skywalking.apache.org/agent.Overlay: &quot;true&quot;
        agent.skywalking.apache.org/agent.service_name: &quot;app&quot;
        agent.skywalking.apache.org/agent.sample_n_per_3_secs: &quot;6&quot;
        agent.skywalking.apache.org/agent.class_cache_mode: &quot;MEMORY&quot;
        agent.skywalking.apache.org/agent.ignore_suffix: &quot;'jpg,.jpeg'&quot;
        plugins.skywalking.apache.org/plugin.mount: &quot;'plugins,activations'&quot;
        plugins.skywalking.apache.org/plugin.mongodb.trace_param: &quot;true&quot;
        plugins.skywalking.apache.org/plugin.influxdb.trace_influxql: &quot;false&quot;
        optional.skywalking.apache.org: &quot;trace|webflux|cloud-gateway-2.1.x&quot;
        optional-reporter.skywalking.apache.org: &quot;kafka&quot;
      namespace: default
    spec:
      containers:
      - name: demo3
        image: ghcr.io/apache/skywalking-swck-spring-demo:v0.0.1
        command: [&quot;java&quot;]
        args: [&quot;-jar&quot;,&quot;/app.jar&quot;]
</code></pre><p>Get injected resources as below:</p>
<pre><code>spec:
  containers:
  - image: nginx:1.16.1
    imagePullPolicy: IfNotPresent
    name: nginx
  - args:
    - -jar
    - /app.jar
    command:
    - java
    env:
    - name: JAVA_TOOL_OPTIONS
      value: -javaagent:/sky/agent/skywalking-agent.jar=agent.ignore_suffix='jpg,.jpeg',agent.class_cache_mode=MEMORY,agent.sample_n_per_3_secs=6,agent.service_name=app,plugin.mount='plugins,activations',plugin.influxdb.trace_influxql=false,plugin.mongodb.trace_param=true
    image: ghcr.io/apache/skywalking-swck-spring-demo:v0.0.1
    name: demo3
    - mountPath: /sky/agent
      name: sky-agent
    - mountPath: /sky/agent/config
      name: java-agent-configmap-volume
  initContainers:
  - args:
    - -c
    - mkdir -p /sky/agent &amp;&amp; cp -r /skywalking/agent/* /sky/agent &amp;&amp; cd /sky/agent/optional-plugins/&amp;&amp;
      ls | grep -E &quot;trace|webflux|cloud-gateway-2.1.x&quot;  | xargs -i cp {} /sky/agent/plugins/
      &amp;&amp; cd /sky/agent/optional-reporter-plugins/&amp;&amp; ls | grep -E &quot;kafka&quot;  | xargs
      -i cp {} /sky/agent/plugins/
    command:
    - sh
    image: apache/skywalking-java-agent:8.10.0-java8
    name: inject-skywalking-agent
    volumeMounts:
    - mountPath: /sky/agent
      name: sky-agent
  volumes:
  - emptyDir: {}
    name: sky-agent
  - configMap:
      name: skywalking-swck-java-agent-configmap
    name: java-agent-configmap-volume
</code></pre><div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ kubectl get configmap skywalking-swck-java-agent-configmap -n default
NAME                                   DATA   AGE
skywalking-swck-java-agent-configmap   <span style="color:#099">1</span>      17s
</code></pre></div><p>Then you can get the final agent configuration and the pod as below.</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ kubectl get javaagent
NAME                  PODSELECTOR   SERVICENAME   BACKENDSERVICE
app-demo3-javaagent   <span style="color:#008080">app</span><span style="color:#000;font-weight:bold">=</span>demo3     app           127.0.0.1:11800
$ kubectl get pod -l <span style="color:#008080">app</span><span style="color:#000;font-weight:bold">=</span>demo3<span style="color:#000;font-weight:bold">(</span>the podSelector<span style="color:#000;font-weight:bold">)</span>
NAME                     READY   STATUS    RESTARTS   AGE
demo3-69bff546df-55w8c   1/1     Running   <span style="color:#099">0</span>          57s
demo3-69bff546df-mn5fq   1/1     Running   <span style="color:#099">0</span>          57s
demo3-69bff546df-skklk   1/1     Running   <span style="color:#099">0</span>          57s
</code></pre></div><p>Get the javaagent&rsquo;s yaml for more datails.</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ kubectl get javaagent app-demo3-javaagent -oyaml
apiVersion: operator.skywalking.apache.org/v1alpha1
kind: JavaAgent
metadata:
  creationTimestamp: <span style="color:#d14">&#34;2021-10-15T05:21:06Z&#34;</span>
  generation: <span style="color:#099">1</span>
  name: app-demo3-javaagent
  namespace: default
  ownerReferences:
  - apiVersion: apps/v1
    blockOwnerDeletion: <span style="color:#0086b3">true</span>
    controller: <span style="color:#0086b3">true</span>
    kind: ReplicaSet
    name: demo3-69bff546df
    uid: 1f04a239-0247-4f5c-967a-64009adae42c
  resourceVersion: <span style="color:#d14">&#34;461000&#34;</span>
  selfLink: /apis/operator.skywalking.apache.org/v1alpha1/namespaces/default/javaagents/app-demo3-javaagent
  uid: be35588e-9b2d-4528-90df-c1a630616632
spec:
  agentConfiguration:
    agent.class_cache_mode: MEMORY
    agent.ignore_suffix: <span style="color:#d14">&#39;&#39;&#39;jpg,.jpeg&#39;&#39;&#39;</span>
    agent.sample_n_per_3_secs: <span style="color:#d14">&#34;6&#34;</span>
    agent.service_name: app
    collector.backend_service: 127.0.0.1:11800
    optional-plugin: trace|webflux|cloud-gateway-2.1.x
    optional-reporter-plugin: kafka
    plugin.influxdb.trace_influxql: <span style="color:#d14">&#34;false&#34;</span>
    plugin.mongodb.trace_param: <span style="color:#d14">&#34;true&#34;</span>
    plugin.mount: <span style="color:#d14">&#39;&#39;&#39;plugins,activations&#39;&#39;&#39;</span>
  backendService: 127.0.0.1:11800
  podSelector: <span style="color:#008080">app</span><span style="color:#000;font-weight:bold">=</span>demo3
  serviceName: app
status:
  creationTime: <span style="color:#d14">&#34;2021-10-15T05:21:06Z&#34;</span>
  expectedInjectiedNum: <span style="color:#099">3</span>
  lastUpdateTime: <span style="color:#d14">&#34;2021-10-15T05:21:10Z&#34;</span>
  realInjectedNum: <span style="color:#099">3</span>
</code></pre></div>



</div>


            </main>
          <div id="toc" class="d-none d-xl-block col-xl-2 td-toc d-print-none">
            




<div class="td-page-meta ml-2 pb-1 pt-2 mb-0">











</div>






<nav id="TableOfContents">
  <ul>
    <li><a href="#java-agent-injector-usage">Java agent injector Usage</a>
      <ul>
        <li><a href="#install-injector">Install injector</a></li>
        <li><a href="#use-default-configuration">Use default configuration</a></li>
        <li><a href="#use-annotation-to-override-sidecar-configuration">Use annotation to override sidecar configuration</a>
          <ul>
            <li></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav>




<script>
  $(function () {
    var $toc = $("#TableOfContents");
    if (!$toc || !$toc.length) {
      return;
    }
    var top = $toc.offset().top;
    $(window).on("scroll", debounce(setTop, 100))
    $(window).on("scroll", debounce(addActive, 30))

    function addActive() {
      var scrollValue = $(window).scrollTop();
      var topEle = null;
      $.each($('main h1, main h2, main h3'), function (index, item) {
        if ($(item).offset().top - 70 > scrollValue) {
          return
        }
        if (!topEle) {
          topEle = item
        } else if ($(item).offset().top >= $(topEle).offset().top) {
          topEle = item
        }
        if (topEle) {
          var id = $(item).attr('id');
          $toc.find('a').removeClass("active").end().find('a[href="' + '#' + id + '"]').addClass("active")
        }
      })
    }

    function setTop() {
      var scrollValue = $(window).scrollTop();
      if (scrollValue >= top - 70) {
        $toc.addClass('fixed')
      } else {
        $toc.removeClass('fixed')
      }
    }

    function debounce(fn, wait) {
      var timeout = null;
      return function () {
        clearTimeout(timeout);
        timeout = setTimeout(() => {
          fn.apply(this, arguments);
        }, wait);
      };
    }
  })

</script>

          </div>

        </div>
      </div>

      
<footer class="py-5 sky-row">
  <div class="container-fluid text-center">
    <div class="">
        
        
        
<ul class="list-inline mb-0">
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Twitter" aria-label="Twitter">
    <a class="text-color" target="_blank" href="https://twitter.com/asfskywalking">
      <i class="iconfont icon-twitter"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Slack" aria-label="Slack">
    <a class="text-color" target="_blank" href="http://s.apache.org/slack-invite">
      <i class="iconfont icon-slack"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Mailing list" aria-label="Mailing list">
    <a class="text-color" target="_blank" href="https://lists.apache.org/list.html?dev@skywalking.apache.org">
      <i class="iconfont icon-email"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="GitHub" aria-label="GitHub">
    <a class="text-color" target="_blank" href="https://github.com/apache/skywalking">
      <i class="iconfont icon-github"></i>
    </a>
  </li>
  
</ul>

        
        
    </div>
    <div class="">

        <small class="text-color">&copy; 2017 - 2022 The Apache Software Foundation All Rights Reserved</small>
        
	
    </div>
    <div class="">
      <small class="text-color mt-4">Apache SkyWalking, SkyWalking, Apache, the Apache feather logo, and the Apache SkyWalking project logo are either registered trademarks or trademarks of the Apache Software Foundation.</small>
    </div>
  </div>
</footer>


    </div>
    



























































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































    
<div id="popup">
    <div class="mask">
        <img src=""/>
    </div>
</div>

    <div class="sidebar-mask"></div>
<div class="sidebar">
    <nav class="nav-links">
        <div class="nav-item"><a href="/docs/" class="nav-link">Projects and Documentation</a></div>
        <div class="nav-item"><a href="/events/" class="nav-link">Events</a></div>
        <div class="nav-item"><a href="/blog/" class="nav-link router-link-exact-active router-link-active">Blog</a>
        </div>
        <div class="nav-item"><a href="/downloads/" class="nav-link">Downloads</a></div>
        <div class="nav-item"><a href="/team/" class="nav-link">Team</a></div>
        <div class="nav-item"><a href="/users/" class="nav-link">Users</a></div>
        <div class="nav-item"><a href="/zh/" class="nav-link">中文博客</a></div>
        <div class="nav-item">
            <div class="dropdown-wrapper open"><a class="dropdown-title"><span>Links</span> <span
                    class="arrow down"></span></a>
                <ul class="nav-dropdown" style="">
                    <li class="dropdown-item">
                        <a href="http://www.apache.org/" target="_blank"
                           rel="noopener noreferrer" class="nav-link external">
                            Apache Software Foundation
                        </a>
                    </li>
                    <li class="dropdown-item">
                        <a href="https://github.com/apache/skywalking/issues"
                           target="_blank" rel="noopener noreferrer"
                           class="nav-link external">
                            GitHub Issue Tracker
                        </a>
                    </li>
                    <li class="dropdown-item">
                        <a href="https://lists.apache.org/list.html?dev@skywalking.apache.org" target="_blank"
                           rel="noopener noreferrer" class="nav-link external">
                            Dev Mailing List
                        </a>
                    </li>
                    <li class="dropdown-item">
                        <a href="http://www.apache.org/licenses/" target="_blank"
                           rel="noopener noreferrer" class="nav-link external">
                            License
                        </a>
                    </li>
                    <li class="dropdown-item">
                        <a href="http://www.apache.org/events/current-event"
                           target="_blank" rel="noopener noreferrer"
                           class="nav-link external">
                            Apache Events
                        </a>
                    </li>
                    <li class="dropdown-item">
                        <a href="http://www.apache.org/security/" target="_blank"
                           rel="noopener noreferrer" class="nav-link external">
                            Security
                        </a>
                    </li>
                    <li class="dropdown-item">
                        <a href="http://www.apache.org/foundation/sponsorship.html"
                           target="_blank" rel="noopener noreferrer"
                           class="nav-link external">
                            Sponsorship and Donate
                        </a>
                    </li>
                    <li class="dropdown-item">
                        <a href="http://www.apache.org/foundation/thanks.html"
                           target="_blank" rel="noopener noreferrer"
                           class="nav-link external">
                            Thanks
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
</div>

    <script src="/js/bootstrap.bundle.min.js"></script>

<script src="https://cdn.jsdelivr.net/npm/@docsearch/js@3"></script>









<script src="/js/main.min.d00d7a99f9e61382b1db35fac38e0e7bdd97f8d3c663a4c4b8d02c3f1d78d894.js" integrity="sha256-0A16mfnmE4Kx2zX6w44Oe92X&#43;NPGY6TEuNAsPx142JQ=" crossorigin="anonymous"></script>


<script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
<script>
    window.onload = () => mermaid.init(undefined, ".language-mermaid");
</script>





  </body>
  <script>
    $(function (){
      $('.doc-menu-button').on('click',function (){
        $('.td-sidebar').toggleClass('active')
      })
      $('.version-select').on('change', function (){
        var selectVersion = $(this).val();
        var prefix = '';
        var url = location.href.replace(/(\/docs\/[a-zA-Z\-]+\/)([\w|\.]+)(\/.*)/, function (match, p1, p2, p3){
          prefix = p1 + selectVersion;
          return p1 + selectVersion + p3
        })
        go2SelectVersion(url, prefix)

      })
      function go2SelectVersion(url, prefix){
        $.ajax({
          url: url,
          type: "get",
          success:function(){
            location.href = url;
          },
          statusCode: {
            404:function(){
              location.href = prefix + '/readme/';
            }
          }
        });
      }
    })
  </script>
</html>
